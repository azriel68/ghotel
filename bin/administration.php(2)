<?
/********************************************************************
 * Alexis ALGOUD													*
 * 08/11/2006 18:43:32												*
 * IHM d'administration de l'application							*
 ********************************************************************/

/**
 * Inclusion des classes
 * Vérification du log de l'utilisateur
 * Affichage de l'en-tête de page et du menu administration
 */
	require("../includes/inc.php");
	is_logged();
	
	if(!is_admin()) {
		entete("Accès refusé");
		erreur ("Vous n'êtes pas autorisé à afficher cette page");
		exit();
	}
	
	entete("Gestion de l'application",'online');

	if(is_hotel_select() && is_admin()){
		menu_admin();
	}
	
	/**
	 * ...
	 */
	
	
	$db = new Tdb();
	
	fiche($db);
	
	$db->close();
	
	
function fiche(&$db){

  $formname="form_edition";
?>
<script language="javascript">
function liste_resa_jour(){
	dt_jour = document.forms['<?=$formname?>'].elements['dt_jour'].value;
	aff_div("../scripts/print_liste_resa.php?dt_jour="+dt_jour);
}

function taxe_sejour_mois() {
	dt_jour = document.forms['<?=$formname?>'].elements['dt_jour'].value;
	aff_div("../scripts/print_taxe_sejour.php?dt_jour="+dt_jour);
}

function aff_div (url){
  document.getElementById('div_print').style['display']="block";
  document.getElementById('iframe_print').src=url;
}
</script>
<?

	$r = new TRequete();
	$t = new TTbl();
	
	$r->nombre_chambre($db);
	$nb_chambre = $r->nb_resultat;
	$r->nombre_categorie($db);
	$nb_catégorie = $r->nb_resultat;
	$r->nombre_produit($db);
	$nb_produit = $r->nb_resultat;
	$r->nombre_client($db);
	$nb_client = $r->nb_resultat;
	
	$form=new TForm("",$formname);
	
	$t->beg_tbl('formcadre',800,2,'','center');
	$t->beg_line("listheader");
	$t->Cell(
		"Editions de l'hotel ".$form->texte('','dt_jour', date("d/m/Y"),12,10 )
	,-1,'',2);
	$t->end_line();
	
	$t->beg_line();
	$t->Cell(
    $t->link("Réservations","javascript:liste_resa_jour()","button_grey")
  );
  $t->Cell("Edition des réservations du jour");
	$t->end_line();
	$t->beg_line();
	$t->Cell(
    $t->link("Taxe de séjour","javascript:taxe_sejour_mois()","button_grey")
  );
  $t->Cell("Taxe de séjour mensuelle");
	$t->end_line();
	$t->beg_line();
	$t->Cell(
    "<div id=\"div_print\" style=\"display:none; height:500px\">
    <iframe id=\"iframe_print\" width=\"100%\" height=\"100%\"></iframe>
    </div>"
  ,-1,'',2);
	$t->end_line();
	$t->end_tbl();
	echo "<br />";
	$t->beg_tbl('formcadre',800,2,'','center');
	$t->beg_line("listheader");
	$t->Cell(
		"Statistiques de l'hotel"
	,-1,'',2);
	$t->end_line();
	$t->beg_line();
	$t->Cell("Nombre de chambres $nb_chambre ");
	$t->end_line();
	$t->beg_line();
	$t->Cell("Nombre de catégories $nb_catégorie ");
	$t->end_line();
	$t->beg_line();
	$t->Cell("Nombre de produits $nb_produit ");
	$t->end_line();
	$t->beg_line();
	$t->Cell("Nombre de clients $nb_client ");
	$t->end_line();


	$t->end_tbl();
	
}	
	
	
?>
